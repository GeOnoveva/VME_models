---
title: "Cut and vectorize"
output: html_notebook
---

# Intro

inputs: pc
outputs:

# Libraries
```{r}
library(terra)
library(dplyr)
library(spatialEco)
```

# Inputs
```{r}
distribution <- rast(file.path(outpath, paste(vme,"minus", paste(remove, collapse=", "), "pred.tif")))
errorr <- rast(file.path(outpath, paste(vme,"minus", paste(remove, collapse=", "), "pred var.tif")))

# Substract
distribution[errorr>quantile(values(errorr, na.rm=TRUE))[4]]<-NA
```

# Threshold
```{r}
val <- values(distribution, na.rm=TRUE) %>% data.frame %>% pull
th <- getJenksBreaks(val, 1)
```

# Vectorize
```{r}
mna <- 800*800
mxh <- 800*800
pol <- threspol(th, raster(distribution), min.area, max.hole)
```

# Save outputs
```{r}
terra::writeRaster(distribution, file.path(outpath, paste(vme,"minus", paste(remove, collapse=", "), "pred cert.tif")), filetype = "GTiff", overwrite = TRUE)
```
